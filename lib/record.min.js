"use strict";function RTCRecord(e,n){var o,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=null,d=t.collectTime||1e3,i={mimeType:"video/webm;codecs=vp9"},c=null;function a(e){e.data&&0<e.data.size&&n&&n(e.data)}return r=e,o={mimeType:"video/webm;codecs=vp9"},MediaRecorder.isTypeSupported(o.mimeType)||(console.error("".concat(o.mimeType," is not Supported")),o={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(o.mimeType)||(console.error("".concat(o.mimeType," is not Supported")),o={mimeType:"video/webm"},MediaRecorder.isTypeSupported(o.mimeType)||(console.error("".concat(o.mimeType," is not Supported")),o={mimeType:""}))),i=o,function(){try{c=new MediaRecorder(r,i)}catch(e){return console.error("Exception while creating MediaRecorder:",e)}c.onstop=function(e){c=null,t.ended&&t.ended()},c.ondataavailable=a,c.start(d)}(),e.onended=function(){e=r=null},c}function CanvasRecord(d,i){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=null,n=null,e=new Promise(function(e){return n=e});function p(){return d.videoHeight||d.clientHeight}function u(){return d.videoWidth||d.clientWidth}function o(){var e,n=((e=document.createElement("canvas")).style.display="none",e.setAttribute("height",p()),e.setAttribute("width",u()),document.body.append(e),e),o=n.getContext("2d"),t=p(),r=u();a=setInterval(function(){o.drawImage(d,0,0,t,r),n.toBlob(function(e){i&&i(e)},"image/webp")},c.duration||200)}function t(){r(),n(),console.log("视频播放完毕！")}function r(){a&&clearInterval(a),d.removeEventListener("canplay",o,!1),d.removeEventListener("ended",t,!1),c.ended&&c.ended()}return d.addEventListener("canplay",o,!1),d.addEventListener("ended",t,!1),{stop:r,canvasRecordPromise:e}}function record(e,n,o){var t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return"undefined"!=typeof MediaRecorder?RTCRecord(e,o,t):CanvasRecord(n,o,t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasRecord=CanvasRecord,exports.RTCRecord=RTCRecord,exports.default=record;
